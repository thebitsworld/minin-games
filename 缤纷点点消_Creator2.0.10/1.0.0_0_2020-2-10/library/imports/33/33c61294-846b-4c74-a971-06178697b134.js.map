{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\script\\Game/assets\\script\\Game\\Tile.js"],"names":["G","require","cc","Class","extends","Component","properties","icon","Sprite","numLabel","default","type","Label","sprites","SpriteFrame","clickEffect","AudioClip","onLoad","self","node","on","Node","EventType","TOUCH_START","event","game","isCal","audioEngine","playEffect","combo","addCoin","setNum","parseInt","string","newTile","row","col","setPosition","width","height","setScale","runAction","scaleTo","setArrPosition","moveTo","stopActionByTag","action","p","setTag","destoryTile","sequence","callFunc","put","num","exeLogic","maxNum","spriteFrame","isMove","operateLogic","hp","powerBarBg","children","length","costBarAction","destroy","removeAllChildren","gameover"],"mappings":"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","file":"Tile.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\Game","sourcesContent":["// var Colors = require(\"Colors\");\r\nvar G = require(\"G\");\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // foo: {\r\n        //    default: null,\r\n        //    url: cc.Texture2D,  // optional, default is typeof default\r\n        //    serializable: true, // optional, default is true\r\n        //    visible: true,      // optional, default is true\r\n        //    displayName: 'Foo', // optional\r\n        //    readonly: false,    // optional, default is false\r\n        // },\r\n        // ...\r\n        icon:cc.Sprite,\r\n        numLabel: {\r\n            default: null,\r\n            type: cc.Label\r\n        },\r\n        sprites:[cc.SpriteFrame],\r\n        clickEffect: cc.AudioClip\r\n    },\r\n\r\n    // use this for initialization\r\n    onLoad: function () {\r\n        var self = this;\r\n        this.node.on(cc.Node.EventType.TOUCH_START, function (event) {\r\n            if (!G.game.isCal) {\r\n                cc.audioEngine.playEffect(self.clickEffect);\r\n                G.game.isCal = true;\r\n                // 连击次数归零\r\n                G.combo = 0;\r\n                cc.audioEngine.playEffect(this.addCoin);\r\n                self.setNum(parseInt(self.numLabel.string) + 1, true, false);\r\n            }\r\n        }, this.node);\r\n    },\r\n    // 产生新方块\r\n    newTile: function (row, col) {\r\n        this.node.setPosition(5 + (5 + this.node.width) * col + this.node.width / 2, 5 + (5 + this.node.height) * row + this.node.height / 2);\r\n        this.node.setScale(0);\r\n        this.node.runAction(cc.scaleTo(0.1, 1));\r\n        this.setArrPosition(row, col);\r\n    },\r\n    // 移动到特定点\r\n    moveTo: function (row, col) {\r\n        this.row = row;\r\n        this.col = col;\r\n        this.node.stopActionByTag(1);\r\n        var action = cc.moveTo(0.2, cc.p(5 + (5 + this.node.width) * col + this.node.width / 2, 5 + (5 + this.node.height) * row + this.node.height / 2));\r\n        this.node.runAction(action);\r\n        action.setTag(1);\r\n    },\r\n    // 方块销毁\r\n    destoryTile: function () {\r\n        var action = cc.sequence(cc.scaleTo(0.1, 0), cc.callFunc(function (node) {\r\n            // node.destroy();\r\n\r\nG.put(\"tilePre\",node);  \r\n            \r\n        }, this.node, this.node));\r\n        this.node.runAction(action);\r\n    },\r\n    // 设置方块在数组的位置\r\n    setArrPosition: function (row, col) {\r\n        this.row = row;\r\n        this.col = col;\r\n    },\r\n    // 设置方块数字\r\n    setNum: function (num, exeLogic, playEffect) {\r\n        G.game.maxNum = num > G.game.maxNum ? num : G.game.maxNum;\r\n        this.numLabel.string = num;\r\n\r\n        this.icon.spriteFrame=this.sprites[num-1];\r\n        // switch (num) {\r\n        //     case 1:\r\n        //         this.node.color = Colors.num1;\r\n        //         break;\r\n        //     case 2:\r\n        //         this.node.color = Colors.num2;\r\n        //         break;\r\n        //     case 3:\r\n        //         this.node.color = Colors.num3;\r\n        //         break;\r\n        //     case 4:\r\n        //         this.node.color = Colors.num4;\r\n        //         break;\r\n        //     case 5:\r\n        //         this.node.color = Colors.num5;\r\n        //         break;\r\n        //     case 6:\r\n        //         this.node.color = Colors.num6;\r\n        //         break;\r\n        //     case 7:\r\n        //         this.node.color = Colors.num7;\r\n        //         break;\r\n        //     case 8:\r\n        //         this.node.color = Colors.num8;\r\n        //         break;\r\n        //     case 9:\r\n        //         this.node.color = Colors.num9;\r\n        //         break;\r\n        //     case 10:\r\n        //         this.node.color = Colors.num10;\r\n        //         break;\r\n        //     case 11:\r\n        //         this.node.color = Colors.num11;\r\n        //         break;\r\n        //     case 12:\r\n        //         this.node.color = Colors.num12;\r\n        //         break;\r\n        //     case 13:\r\n        //         this.node.color = Colors.num13;\r\n        //         break;\r\n        //     case 14:\r\n        //         this.node.color = Colors.num14;\r\n        //         break;\r\n        //     case 15:\r\n        //         this.node.color = Colors.num15;\r\n        //         break;\r\n        //     case 16:\r\n        //         this.node.color = Colors.num16;\r\n        //         break;\r\n        //     case 17:\r\n        //         this.node.color = Colors.num17;\r\n        //         break;\r\n        //     case 18:\r\n        //         this.node.color = Colors.num18;\r\n        //         break;\r\n        //     case 19:\r\n        //         this.node.color = Colors.num19;\r\n        //         break;\r\n        //     case 20:\r\n        //         this.node.color = Colors.num20;\r\n        //         break;\r\n        //     default:\r\n        //         this.node.color = Colors.nums;\r\n        //         break;\r\n        // }\r\n        // 播放特效\r\n        if (playEffect) {\r\n            this.node.runAction(cc.sequence(cc.scaleTo(0.15, 1.5), cc.scaleTo(0.15, 1)));\r\n        }\r\n        // 消除逻辑\r\n        if (exeLogic) {\r\n            // 执行逻辑\r\n            var isMove = G.game.operateLogic(this.row, this.col, parseInt(this.numLabel.string), true);\r\n            // var powers = G.game.powers;\r\n            // 能量条-1\r\n            if (!isMove) {\r\n                // for (var i = powers.length - 1; i >= 0; i--) {\r\n                //     if (powers[i] != null) {\r\n                //         var costBarAction = cc.sequence(cc.scaleTo(0.1, 0), cc.callFunc((power) => {\r\n                //             power.destroy();\r\n                //         }, null, powers[i]));\r\n                //         powers[i].runAction(costBarAction);\r\n                //         powers[i] = null;\r\n                //         break;\r\n                //     }\r\n                // };\r\n\r\n               \r\n\r\n                G.game.hp--;\r\n                let node = G.game.powerBarBg.children[G.game.powerBarBg.children.length - 1];\r\n\r\n                var costBarAction = cc.sequence(cc.scaleTo(0.1, 0), cc.callFunc(() => {\r\n                \r\n                    node.destroy();\r\n                }));\r\n                node.runAction(costBarAction);\r\n                // powers[i] = null;\r\n\r\n\r\n\r\n                // 游戏结束逻辑判断：能量条为空\r\n                if (G.game.hp <= 0) {\r\n\r\n                    G.game.powerBarBg.removeAllChildren();\r\n\r\n                    // G.score = G.game.scoreNum.string;\r\n\r\n                    // Game Over\r\n                    // cc.director.loadScene(\"overScene\");\r\n                    G.game.gameover();\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // called every frame, uncomment this function to activate update callback\r\n    // update: function (dt) {\r\n\r\n    // },\r\n});"]}